{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="container mx-auto mt-12 max-w-2xl bg-white p-8 rounded-2xl shadow-lg text-gray-800">

  <!-- Header -->
  <h1 class="text-3xl font-bold text-center mb-2">Profile</h1>
  <p class="text-center text-gray-500 mb-8">Manage your information and account</p>

  <!-- Summary Cards -->
  <div class="grid grid-cols-2 gap-4 mb-10">
    <div class="bg-green-50 p-5 rounded-xl shadow-sm text-center">
      <p class="text-2xl font-bold text-green-600">â‚¹{{ total_spent }}</p>
      <p class="text-gray-500 text-sm">Total Spent</p>
    </div>
    <div class="bg-blue-50 p-5 rounded-xl shadow-sm text-center">
      <p class="text-2xl font-bold text-blue-600">{{ total_transactions }}</p>
      <p class="text-gray-500 text-sm">Transactions</p>
    </div>
  </div>

  <!-- Edit Profile -->
  <div class="bg-gray-50 p-6 rounded-xl border mb-6">
    <h2 class="text-lg font-semibold mb-4 text-center">Edit Profile</h2>

    <form method="POST" class="space-y-4">
      {% csrf_token %}
      {% if messages %}
        <div class="text-center mb-3">
          {% for message in messages %}
            <p class="text-sm {% if message.tags == 'error' %}text-red-600{% else %}text-green-600{% endif %}">
              {{ message }}
            </p>
          {% endfor %}
        </div>
      {% endif %}

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
        <input type="text" name="username" value="{{ user.username }}" 
               class="border border-gray-300 focus:border-green-400 focus:ring-green-300 w-full p-2 rounded-md">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
        <input type="email" name="email" value="{{ user.email }}" 
               class="border border-gray-300 focus:border-green-400 focus:ring-green-300 w-full p-2 rounded-md">
      </div>

      <div class="text-center mt-5">
        <button type="submit" 
                class="bg-green-500 hover:bg-green-600 text-white font-medium px-6 py-2 rounded-md transition">
          Save Changes
        </button>
      </div>
    </form>
  </div>

  <!-- Account Actions -->
  <div class="flex flex-col sm:flex-row justify-center gap-4 text-center">
    
    <form method="POST" action="{% url 'delete_account' %}" 
          onsubmit="return confirm('Are you sure you want to permanently delete your account? This action cannot be undone.');">
      {% csrf_token %}
      <button type="submit" 
              class="bg-gray-100 border border-red-300 text-red-600 px-6 py-2 rounded-md hover:bg-red-50 hover:border-red-400 transition">
        Delete Account
      </button>
    </form>

    <form method="post" action="{% url 'logout' %}">
      {% csrf_token %}
      <button type="submit" 
              class="bg-red-500 text-white px-6 py-2 rounded-md hover:bg-red-600 transition">
        Logout
      </button>
    </form>

  </div>
</div>

{% endblock %}
