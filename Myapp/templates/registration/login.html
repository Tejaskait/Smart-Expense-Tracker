{% extends 'base.html' %}
{% block content %}
<style>
/* Autofill fix for Chrome, Safari, Edge */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active {
    -webkit-box-shadow: 0 0 0 1000px rgba(255, 255, 255, 0.05) inset !important;
    -webkit-text-fill-color: white !important;
    transition: background-color 5000s ease-in-out 0s;
}
</style>

<div class="flex justify-center items-center min-h-screen bg-gray-900/50 backdrop-blur-sm">
  <div class="bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-2xl w-96 p-8">
    <h2 class="text-2xl font-extrabold mb-2 text-white text-center">Welcome Back, Please Login !</h2>

    {% if error %}
      <p class="text-red-400 text-center mb-3">{{ error }}</p>
    {% endif %}

    <form method="POST" class="space-y-4" autocomplete="on">
      {% csrf_token %}

      <!-- identifier: accepts email or username -->
      <input
        type="text"
        name="identifier"
        placeholder="Email or Username"
        autocomplete="username"
        required
        class="w-full px-3 py-2 rounded-lg border border-white/20 bg-transparent text-white placeholder-white/50 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-white/30 transition duration-300"
      />

      <!-- Password with eye toggle -->
      <div class="relative">
        <input
          id="password"
          type="password"
          name="password"
          placeholder="Password"
          autocomplete="current-password"
          required
          class="w-full px-3 py-2 rounded-lg border border-white/20 bg-transparent text-white placeholder-white/50 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-white/30 transition duration-300 pr-12"
        />

        <button
          type="button"
          id="togglePassword"
          aria-label="Show password"
          class="absolute right-3 inset-y-0 flex items-center p-1 focus:outline-none"
        >
          <!-- Eye SVG (toggle between show/hide via JS) -->
          <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white/90" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M2.5 12s3.5-7 9.5-7S21.5 12 21.5 12s-3.5 7-9.5 7S2.5 12 2.5 12z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        </button>
      </div>

      <button
        type="submit"
        class="w-full py-2 border rounded-lg bg-blue-500/30 hover:bg-blue-500/50 text-white font-medium transition duration-300"
      >
        Login
      </button>
    </form>

    <p class="text-center mt-4 text-white/70 text-sm">
      Donâ€™t have an account?
      <a href="{% url 'signup' %}" class="text-blue-400 hover:underline">Sign up</a>
    </p>
  </div>
</div>

<script>
(function () {
  const pwd = document.getElementById('password');
  const btn = document.getElementById('togglePassword');
  const eyeIcon = document.getElementById('eyeIcon');

  // store two svg path states (visible / hidden) by swapping the innerHTML
  const eyeVisible = '<path d="M2.5 12s3.5-7 9.5-7S21.5 12 21.5 12s-3.5 7-9.5 7S2.5 12 2.5 12z"></path><circle cx="12" cy="12" r="3"></circle>';
  const eyeHidden = '<path d="M3 3l18 18"></path><path d="M2.5 12s3.5-7 9.5-7 9.5 7 9.5 7-3.5 7-9.5 7S2.5 12 2.5 12z"></path><circle cx="12" cy="12" r="3"></circle>';

  let showing = false;

  btn.addEventListener('click', function (e) {
    e.preventDefault();
    showing = !showing;
    if (showing) {
      pwd.type = 'text';
      btn.setAttribute('aria-label', 'Hide password');
      // slightly change icon -- using a slash to indicate hidden (we toggle innerHTML)
      eyeIcon.innerHTML = eyeHidden;
    } else {
      pwd.type = 'password';
      btn.setAttribute('aria-label', 'Show password');
      eyeIcon.innerHTML = eyeVisible;
    }
  });

  // allow toggling via keyboard (Enter/Space)
  btn.addEventListener('keydown', function (e) {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      btn.click();
    }
  });
})();
</script>

{% endblock %}
